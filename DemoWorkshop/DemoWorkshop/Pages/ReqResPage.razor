@page "/reqres"
@inject IReqResData servizio


@if (PostData == null)
{
    <button @onclick="CreaUtente" class="btn btn-danger">Crea  Utente</button>
    @Message

    <ListaUtenti OnModifica="Modifica"></ListaUtenti>
}
else
{
    <DettaglioReqResPost Elemento="PostData" OnSalva="Salva" OnAnnulla="Annulla">

        <CampiDelForm>
            <MyInputText Id="nome" Label="Nome:" @bind-Value="PostData.name"></MyInputText>
            <MyInputText Id="job" Label="Job:" @bind-Value="PostData.job"></MyInputText>
        </CampiDelForm>

    </DettaglioReqResPost>
}

@code {

    private ReqResPost PostData;
    public string Message = "";

    private void CreaUtente()
    {
        PostData = new ReqResPost();
    }

    private void Modifica(Person persona)
    {
        PostData = new ReqResPost { name = persona.first_name + " " + persona.last_name };
    }


    private void Annulla()
    {
        PostData = null;
        Message = "";
    }

    private async Task Salva()
    {
        var status = await servizio.CreaUtente(PostData);
        Message = status.ToString();
        PostData = null;
    }
}
